import { Prisma, PrismaClient } from "@prisma/client";
import { Router, response } from "express";

const prisma = new PrismaClient();
const productsrouter = Router();

export const getAllProducts=async (req,res)=>{
    try{
        const products=await prisma.products.findMany();
        res.status(200).json({products})
    }catch(e){
        res.status(500).json({success:false,message:"oops!an error occured,try again later"})
    }        
    }
        
    export const getSingleProduct=async (req,res)=>{
        const {id}=req.params;
        try{
            const products=await prisma.products.findFirst({
                where:{id:id} })
                if(!products){
                    res.status(404).json({success:false,message:"OOps!!Product not found"})
                }else{
                    res.status(200).json(products)
                }
                res.status(200).json(products)
           ;
          
        }catch(e){
            res.status(500).json({success:false,message:"oops!!an error occured .Try again later"})
        }
    }

    export const  createProduct=async (req,res)=>{
        const{id,productName, productPrice,productDescription,productImage, productsRemaining}=req.body;
        try{
            const products=await prisma.products.create({data:
                id, 
                productName, 
                productPrice,  
                productDescription,  
                productImage,
                productsRemaining     
            })
            res.status(200).json(products)
        }catch(e){
            res.status(500).json({message:"oops!Error while creating Product..."})
        }
    }

    export const deleteProduct=async (req,res)=>{
        const {id}=req.params;
        try{
            const products=await prisma.products.delete({where:{id:id}})
            if(!products){
                res.status(404).json({message:"Oops!! Product not found..."})
            }else{
                res.status(200).json(products)
            }
            res.status(200).json(products)
        }catch(e){
            res.status(500).json({message:"Oops!!an error occured..."})
        }
    }